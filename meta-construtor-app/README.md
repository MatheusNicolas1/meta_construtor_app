# MetaConstrutor - Sistema Completo de Gest√£o de Obras

<div align="center">

![MetaConstrutor](https://img.shields.io/badge/MetaConstrutor-v2.0-blue?style=for-the-badge)
![React](https://img.shields.io/badge/React-18.x-blue?style=flat-square&logo=react)
![TypeScript](https://img.shields.io/badge/TypeScript-5.x-blue?style=flat-square&logo=typescript)
![Supabase](https://img.shields.io/badge/Supabase-Backend-green?style=flat-square&logo=supabase)
![Vercel](https://img.shields.io/badge/Vercel-Deployed-black?style=flat-square&logo=vercel)

**Sistema completo de gest√£o de obras e constru√ß√£o civil com funcionalidades avan√ßadas de RDO, or√ßamento anal√≠tico, controle de equipes e equipamentos.**

[üöÄ Demo Live](https://meta-construtor-2z53vmjv9-matheus-projects-75ad76a6.vercel.app) | [üìö Documenta√ß√£o](#documenta√ß√£o) | [üõ†Ô∏è Instala√ß√£o](#instala√ß√£o)

</div>

## üèóÔ∏è Vis√£o Geral

O MetaConstrutor √© uma aplica√ß√£o web moderna e responsiva para gest√£o completa de obras de constru√ß√£o civil, desenvolvida com as mais recentes tecnologias web e integrada com Supabase para um back-end robusto e escal√°vel.

### ‚ú® Principais Funcionalidades

#### üéØ **Core Features**
- **Sistema de RDO (Relat√≥rios Di√°rios de Obra)** com coleta via WhatsApp
- **Gest√£o completa de obras** com or√ßamento anal√≠tico/sint√©tico
- **Controle de equipes e colaboradores** com aloca√ß√£o din√¢mica
- **Gerenciamento de equipamentos** (pr√≥prios/alugados) com controle de uso
- **Sistema de atividades padronizadas** para reutiliza√ß√£o
- **Gera√ß√£o de relat√≥rios avan√ßados** (PDF/Excel) com cabe√ßalhos personalizados
- **Dashboard executivo** com KPIs em tempo real

#### üîí **Seguran√ßa e Permiss√µes**
- **Autentica√ß√£o robusta** com Supabase Auth
- **Sistema de permiss√µes por roles** (Diretor, Gerente, Colaborador)
- **Controle de dados financeiros** (apenas Diretores e Gerentes visualizam)
- **Isolamento de dados por empresa** (multicliente)
- **Row Level Security (RLS)** no banco de dados

#### üì± **Experi√™ncia do Usu√°rio**
- **Modo offline inteligente** com sincroniza√ß√£o autom√°tica
- **Design responsivo** mobile-first
- **Tema adaptativo** (dark/light/system)
- **Interface moderna** com shadcn/ui e Tailwind CSS
- **Loading states** e tratamento de erros em toda aplica√ß√£o

#### üîó **Integra√ß√µes e Storage**
- **Supabase Storage** organizado por estrutura hier√°rquica
- **Upload de arquivos** com valida√ß√£o de tipos
- **Sistema de documentos** categorizados por obra
- **Preparado para integra√ß√µes** (Google Calendar, WhatsApp Business)

## üèõÔ∏è Arquitetura do Sistema

### üìä Estrutura do Banco de Dados

```mermaid
erDiagram
    empresas ||--o{ obras : "possui"
    empresas ||--o{ equipes : "possui"
    empresas ||--o{ equipamentos : "possui"
    empresas ||--o{ fornecedores : "possui"
    
    obras ||--o{ orcamento_analitico : "cont√©m"
    obras ||--o{ obras_equipes : "aloca"
    obras ||--o{ obras_equipamentos : "utiliza"
    obras ||--o{ documentos : "anexa"
    obras ||--o{ rdos : "gera"
    
    equipes ||--o{ colaboradores : "tem"
    equipes ||--o{ obras_equipes : "trabalha_em"
    
    equipamentos ||--o{ obras_equipamentos : "usado_em"
    
    fornecedores ||--o{ materiais : "fornece"
    
    orcamento_analitico ||--o{ materiais_atividades : "usa"
    materiais ||--o{ materiais_atividades : "pertence"
    
    profiles ||--|| empresas : "trabalha_para"
    
    rdos ||--o{ anexos : "possui"
```

### üóÇÔ∏è Tabelas Principais

#### **Core Business**
- `empresas` - Gest√£o multicliente
- `obras` - Projetos e obras
- `orcamento_analitico` - Or√ßamento detalhado por atividade
- `rdos` - Relat√≥rios di√°rios de obra

#### **Recursos Humanos**
- `equipes` - Organiza√ß√£o de equipes
- `colaboradores` - Cadastro de funcion√°rios
- `obras_equipes` - V√≠nculo obras-equipes

#### **Equipamentos e Materiais**
- `equipamentos` - Controle de equipamentos
- `obras_equipamentos` - Aloca√ß√£o de equipamentos
- `fornecedores` - Cadastro de fornecedores
- `materiais` - Cat√°logo de materiais
- `materiais_atividades` - Materiais por atividade

#### **Documenta√ß√£o e M√≠dia**
- `documentos` - Arquivos categorizados
- `anexos` - Fotos e arquivos diversos
- `atividades` - Biblioteca de atividades padr√£o

#### **Controle de Acesso**
- `profiles` - Perfis de usu√°rio estendidos
- Pol√≠ticas RLS para seguran√ßa

### üèóÔ∏è Stack Tecnol√≥gica

#### **Frontend**
- **React 18** - Framework principal
- **TypeScript** - Tipagem est√°tica
- **Vite** - Build tool r√°pido
- **Tailwind CSS** - Estiliza√ß√£o utilit√°ria
- **shadcn/ui** - Componentes UI modernos
- **React Router** - Roteamento
- **date-fns** - Manipula√ß√£o de datas
- **Lucide React** - √çcones

#### **Backend e Infraestrutura**
- **Supabase** - Backend as a Service
- **PostgreSQL** - Banco de dados relacional
- **Supabase Auth** - Autentica√ß√£o
- **Supabase Storage** - Armazenamento de arquivos
- **Row Level Security (RLS)** - Seguran√ßa de dados
- **Vercel** - Deploy e hospedagem

## üöÄ Deploy e URLs

### üåê URLs de Produ√ß√£o
- **Aplica√ß√£o Principal**: https://meta-construtor-2z53vmjv9-matheus-projects-75ad76a6.vercel.app
- **Supabase Dashboard**: https://supabase.com/dashboard/project/cajwnsgjqkxejfqvlggm
- **Vercel Dashboard**: https://vercel.com/matheus-projects-75ad76a6/meta-construtor-hub

### ‚öôÔ∏è Configura√ß√µes de Deploy

#### **Vari√°veis de Ambiente**
```env
VITE_SUPABASE_URL=https://cajwnsgjqkxejfqvlggm.supabase.co
VITE_SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
```

#### **Configura√ß√£o Vercel** (`vercel.json`)
```json
{
  "framework": "vite",
  "buildCommand": "npm run build",
  "outputDirectory": "dist",
  "installCommand": "npm install",
  "devCommand": "npm run dev"
}
```

## üõ†Ô∏è Instala√ß√£o e Configura√ß√£o

### üìã Pr√©-requisitos
- Node.js 18+ 
- npm ou yarn
- Conta no Supabase
- Conta na Vercel (opcional)

### üîß Configura√ß√£o Local

1. **Clone o reposit√≥rio**
```bash
git clone [URL_DO_REPOSITORIO]
cd meta-construtor-app
```

2. **Instale as depend√™ncias**
```bash
npm install
```

3. **Configure as vari√°veis de ambiente**
```bash
cp .env.example .env.local
# Edite .env.local com suas credenciais do Supabase
```

4. **Execute as migra√ß√µes do banco**
```bash
# No painel do Supabase, execute os arquivos SQL em ordem:
# - supabase/migrations/001_create_tables.sql
# - supabase/migrations/002_seed_data.sql
# - supabase/migrations/003_complete_structure.sql
# - supabase/migrations/004_setup_storage.sql
# - supabase/migrations/005_seed_complete_data.sql
```

5. **Inicie o servidor de desenvolvimento**
```bash
npm run dev
```

### üóÑÔ∏è Configura√ß√£o do Supabase

#### **1. Banco de Dados**
Execute as migra√ß√µes SQL na seguinte ordem no Supabase SQL Editor:

1. `001_create_tables.sql` - Estrutura b√°sica
2. `002_seed_data.sql` - Dados iniciais  
3. `003_complete_structure.sql` - Estrutura completa
4. `004_setup_storage.sql` - Configura√ß√£o de storage
5. `005_seed_complete_data.sql` - Dados completos de exemplo

#### **2. Storage Buckets**
Os buckets s√£o criados automaticamente pela migra√ß√£o 004:
- `obras-anexos` - Documentos e anexos de obras
- `rdo-imagens` - Imagens dos RDOs
- `documentos` - Documentos categorizados
- `avatars` - Fotos de perfil (p√∫blico)

#### **3. Pol√≠ticas de Seguran√ßa**
- RLS habilitado em todas as tabelas
- Isolamento de dados por empresa
- Controle de permiss√µes por role
- Valida√ß√£o de tipos de arquivo
- Estrutura hier√°rquica de pastas

## üë• Sistema de Permiss√µes

### üîê N√≠veis de Acesso

#### **üëë Diretor**
- Acesso total ao sistema
- Visualiza√ß√£o de dados financeiros
- Gest√£o de todas as empresas
- Cria√ß√£o e edi√ß√£o de obras
- Relat√≥rios completos

#### **üë®‚Äçüíº Gerente**
- Gest√£o de obras da empresa
- Visualiza√ß√£o de dados financeiros
- Controle de equipes e equipamentos
- Relat√≥rios da empresa
- Aprova√ß√£o de RDOs

#### **üë∑ Colaborador**
- Visualiza√ß√£o de obras atribu√≠das
- Cria√ß√£o de RDOs
- Visualiza√ß√£o de atividades
- Sem acesso a dados financeiros

### üõ°Ô∏è Implementa√ß√£o de Seguran√ßa

```typescript
// Verifica√ß√£o de permiss√µes no frontend
const { canViewFinancialData, checkPermission } = useAuth();

// Fun√ß√£o no backend (Supabase)
pode_ver_dados_financeiros(user_id UUID) RETURNS BOOLEAN

// RLS Policies
CREATE POLICY "users_can_view_company_data" ON obras 
FOR SELECT USING (empresa_id = user_empresa_id());
```

## üìà Funcionalidades Implementadas

### ‚úÖ **Gest√£o de Obras**
- [x] Cria√ß√£o com or√ßamento sint√©tico/anal√≠tico
- [x] Aloca√ß√£o din√¢mica de equipes e equipamentos
- [x] Upload de documentos categorizados
- [x] Visualiza√ß√£o completa com m√©tricas
- [x] Controle de status e prazos
- [x] Relat√≥rios financeiros (permiss√£o)

### ‚úÖ **Or√ßamento Anal√≠tico**
- [x] Atividades detalhadas com quantitativos
- [x] C√°lculo autom√°tico de valores totais
- [x] Materiais vinculados por atividade
- [x] Controle de status de execu√ß√£o
- [x] Relat√≥rios de execu√ß√£o or√ßament√°ria

### ‚úÖ **Gest√£o de Equipes**
- [x] Cadastro de equipes e colaboradores
- [x] Aloca√ß√£o para obras espec√≠ficas
- [x] Controle de disponibilidade
- [x] Transfer√™ncia entre equipes
- [x] Relat√≥rios de produtividade

### ‚úÖ **Controle de Equipamentos**
- [x] Cadastro pr√≥prios/alugados
- [x] Controle de status e localiza√ß√£o
- [x] Aloca√ß√£o por obra e per√≠odo
- [x] C√°lculo de custos de utiliza√ß√£o
- [x] Agendamento de manuten√ß√µes
- [x] Relat√≥rios de utiliza√ß√£o

### ‚úÖ **Sistema de Documentos**
- [x] Upload organizado por obra/categoria
- [x] Valida√ß√£o de tipos de arquivo
- [x] Versionamento de documentos
- [x] URLs p√∫blicas seguras
- [x] Limpeza de arquivos √≥rf√£os

### ‚úÖ **Seguran√ßa e Permiss√µes**
- [x] Autentica√ß√£o com Supabase Auth
- [x] Controle por roles (Diretor/Gerente/Colaborador)
- [x] RLS para isolamento de dados
- [x] Valida√ß√£o de permiss√µes financeiras
- [x] Multicliente (isolamento por empresa)

## üìä Estrutura de Dados

### üè¢ **Modelo de Empresa (Multicliente)**
```sql
CREATE TABLE empresas (
  id UUID PRIMARY KEY,
  nome TEXT NOT NULL,
  cnpj TEXT UNIQUE,
  plano TEXT CHECK (plano IN ('basico', 'profissional', 'empresarial')),
  status TEXT CHECK (status IN ('ativa', 'inativa', 'suspensa'))
);
```

### üèóÔ∏è **Obras com Or√ßamento Anal√≠tico**
```sql
CREATE TABLE obras (
  id UUID PRIMARY KEY,
  nome TEXT NOT NULL,
  orcamento DECIMAL(15,2),
  empresa_id UUID REFERENCES empresas(id)
);

CREATE TABLE orcamento_analitico (
  id UUID PRIMARY KEY,
  obra_id UUID REFERENCES obras(id),
  nome_atividade TEXT NOT NULL,
  quantitativo DECIMAL(12,3),
  valor_unitario DECIMAL(10,2),
  valor_total DECIMAL(15,2) GENERATED ALWAYS AS (quantitativo * valor_unitario) STORED
);
```

### üë• **V√≠nculos Obras-Equipes-Equipamentos**
```sql
CREATE TABLE obras_equipes (
  obra_id UUID REFERENCES obras(id),
  equipe_id UUID REFERENCES equipes(id),
  data_alocacao DATE,
  status TEXT CHECK (status IN ('ativa', 'liberada', 'transferida'))
);

CREATE TABLE obras_equipamentos (
  obra_id UUID REFERENCES obras(id),
  equipamento_id UUID REFERENCES equipamentos(id),
  quantidade INTEGER,
  horas_utilizadas DECIMAL(8,2),
  custo_total DECIMAL(10,2)
);
```

## üîÑ Fluxo de Trabalho

### 1. **Cria√ß√£o de Obra**
```mermaid
graph TD
    A[Criar Obra] --> B{Tipo Or√ßamento?}
    B -->|Sint√©tico| C[Valor Total]
    B -->|Anal√≠tico| D[Atividades Detalhadas]
    D --> E[Materiais por Atividade]
    C --> F[Alocar Equipes]
    E --> F
    F --> G[Alocar Equipamentos]
    G --> H[Upload Documentos]
    H --> I[Obra Criada]
```

### 2. **Execu√ß√£o e Controle**
```mermaid
graph TD
    A[Obra Ativa] --> B[RDOs Di√°rios]
    A --> C[Controle Equipamentos]
    A --> D[Gest√£o Equipes]
    B --> E[Relat√≥rios]
    C --> F[Custos Reais]
    D --> G[Produtividade]
    E --> H[Dashboard KPIs]
    F --> H
    G --> H
```

## üìà M√©tricas e KPIs

### üéØ **Dashboard Principal**
- Obras ativas vs. total de obras
- Equipes ocupadas vs. dispon√≠veis  
- Equipamentos em uso vs. dispon√≠veis
- Execu√ß√£o or√ßament√°ria (apenas roles autorizados)
- RDOs gerados no m√™s
- Taxa de utiliza√ß√£o de recursos

### üìä **Relat√≥rios Dispon√≠veis**
- **Financeiro por Obra** (Diretores/Gerentes)
- **Produtividade de Equipes**
- **Utiliza√ß√£o de Equipamentos**
- **Status de Obras**
- **Materiais por Atividade**

## üîß Manuten√ß√£o e Escalabilidade

### üöÄ **Otimiza√ß√µes Implementadas**
- √çndices otimizados no banco de dados
- Queries com joins eficientes
- Cache de dados no frontend
- Lazy loading de componentes
- Compress√£o de assets (Gzip)
- CDN para arquivos est√°ticos

### üìà **Preparado para Escala**
- Arquitetura serverless (Vercel + Supabase)
- Isolamento de dados por empresa
- Pol√≠ticas RLS otimizadas
- Storage organizado hierarquicamente
- Fun√ß√µes de limpeza autom√°tica

### üîç **Monitoramento**
- Logs detalhados de erros
- M√©tricas de performance
- Monitoramento de uso de storage
- Alertas de falhas de deploy

## ü§ù Contribui√ß√£o

### üìù **Padr√µes de C√≥digo**
- TypeScript strict mode
- ESLint + Prettier configurados
- Conventional Commits
- Componentes funcionais com hooks
- Separa√ß√£o clara de responsabilidades

### üß™ **Testes**
- Testes unit√°rios com Jest
- Testes de integra√ß√£o
- Testes E2E com Cypress
- Cobertura m√≠nima de 80%

## üìÑ Licen√ßa

Este projeto est√° licenciado sob a [Licen√ßa MIT](LICENSE).

## üÜò Suporte

Para d√∫vidas ou problemas:

1. **Issues**: Abra uma issue no GitHub
2. **Email**: contato@metaconstrutor.com
3. **Documenta√ß√£o**: Consulte esta documenta√ß√£o completa

---

<div align="center">

**Desenvolvido com ‚ù§Ô∏è para revolucionar a gest√£o de obras**

![Supabase](https://img.shields.io/badge/Powered%20by-Supabase-green?style=flat-square&logo=supabase)
![Vercel](https://img.shields.io/badge/Deployed%20on-Vercel-black?style=flat-square&logo=vercel)

</div>
